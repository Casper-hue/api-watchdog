# 前后端对接检查清单

## 阶段1：后端先行

### ✅ 已完成
- [x] 实现所有API端点（按contract定义）
- [x] 用Postman/curl测试每个端点
- [x] 返回的JSON严格匹配 contracts/api.types.ts
- [x] 写好Swagger文档：http://localhost:8000/docs

### 🔧 需要验证
- [ ] 确认所有API端点返回正确的数据格式
- [ ] 验证错误处理机制
- [ ] 测试边界情况和异常输入

## 阶段2：前端Mock

### ✅ 已完成
- [x] 创建前端类型定义文件 lib/api.types.ts
- [x] 更新组件使用契约定义的类型
- [x] 确认UI渲染正常

### 🔧 需要验证
- [ ] 替换Mock数据为真实API调用
- [ ] 确认所有交互逻辑正常
- [ ] 测试数据加载状态和错误处理

## 阶段3：真实对接

### 🔧 待完成
- [ ] 替换Mock数据为真实API调用
- [ ] 逐个页面测试
- [ ] 错误处理（网络失败、数据格式错误）
- [ ] 性能优化（缓存、懒加载）

## 验收标准

### 后端验收标准
- [ ] 所有测试用例通过
- [ ] Swagger文档完整
- [ ] 日志清晰无报错
- [ ] API响应时间 < 200ms
- [ ] 错误码和消息规范统一

### 前端验收标准
- [ ] 能正确展示真实数据
- [ ] 图表动画流畅
- [ ] 移动端适配正常
- [ ] 加载状态和错误处理完善
- [ ] 用户体验流畅

## 测试清单

### API端点测试
- [ ] GET /api/dashboard/summary
- [ ] GET /api/projects
- [ ] GET /api/projects/{id}/stats
- [ ] GET /api/activities/recent
- [ ] POST /api/feedback

### 数据格式验证
- [ ] DashboardSummary 格式正确
- [ ] ActivityFeed 格式正确
- [ ] ProjectList 格式正确
- [ ] ProjectStats 格式正确
- [ ] 错误响应格式正确

### 前端组件测试
- [ ] StatCards 组件数据渲染正确
- [ ] ActivityFeed 组件数据渲染正确
- [ ] ConsumptionChart 组件数据渲染正确
- [ ] 所有组件错误处理正常

## 部署检查

### 环境配置
- [ ] 后端环境变量配置正确
- [ ] 前端API URL配置正确
- [ ] 数据库连接正常
- [ ] CORS配置正确

### 性能检查
- [ ] 页面加载时间 < 3秒
- [ ] API响应时间 < 500ms
- [ ] 内存使用正常
- [ ] 无内存泄漏

## 监控和维护

### 监控指标
- [ ] API调用次数监控
- [ ] 错误率监控
- [ ] 响应时间监控
- [ ] 用户行为分析

### 维护计划
- [ ] 定期数据备份
- [ ] 日志轮转配置
- [ ] 性能优化计划
- [ ] 安全更新计划

## 问题排查指南

### 常见问题
1. **API返回404错误**
   - 检查后端服务是否启动
   - 确认API路径是否正确
   - 检查CORS配置

2. **数据格式不匹配**
   - 对比 contracts/api.types.ts 和实际返回数据
   - 检查前端类型定义是否正确
   - 验证API响应格式

3. **前端渲染错误**
   - 检查浏览器开发者工具控制台
   - 验证数据加载状态
   - 检查组件props传递

4. **性能问题**
   - 检查网络请求时间
   - 分析前端组件渲染性能
   - 优化API查询效率

## 更新日志

### 2024-02-01 - 契约式开发改进
- ✅ 创建数据契约文件 contracts/api.types.ts
- ✅ 完善测试体系，创建详细的业务场景测试
- ✅ 统一前后端数据格式，确保API响应一致
- ✅ 更新后端API路由以符合契约格式
- ✅ 创建前端类型定义文件 lib/api.types.ts
- ✅ 更新前端组件使用契约定义的类型

### 下一步计划
- [ ] 完成真实数据对接测试
- [ ] 优化性能和数据加载
- [ ] 完善错误处理和用户体验
- [ ] 部署到生产环境